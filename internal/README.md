# Sing-box Manager

ä¸€ä¸ªåŸºäºGoè¯­è¨€çš„sing-boxç”¨æˆ·ç®¡ç†ç³»ç»Ÿï¼Œæä¾›RESTful APIè¿›è¡Œç”¨æˆ·CRUDæ“ä½œï¼Œæ”¯æŒæ—¶é—´/æµé‡/è®¾å¤‡æ•°ä¸‰é‡é™åˆ¶ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ” ç”¨æˆ·ç®¡ç†ï¼šåˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ç”¨æˆ·
- ğŸ“Š æµé‡ç»Ÿè®¡ï¼šå®æ—¶æµé‡ä½¿ç”¨ç»Ÿè®¡å’Œé™åˆ¶
- ğŸ“± è®¾å¤‡ç®¡ç†ï¼šè®¾å¤‡è¿æ¥æ•°é™åˆ¶å’Œç®¡ç†
- â° æ—¶é—´æ§åˆ¶ï¼šç”¨æˆ·è¿‡æœŸæ—¶é—´ç®¡ç†å’Œè‡ªåŠ¨æ¸…ç†
- ğŸ³ å®¹å™¨åŒ–ï¼šDockerä¸€é”®éƒ¨ç½²
- ğŸ”„ çƒ­æ›´æ–°ï¼šé…ç½®æ–‡ä»¶çƒ­é‡è½½
- ğŸ›¡ï¸ å¹¶å‘å®‰å…¨ï¼šæ”¯æŒé«˜å¹¶å‘è®¿é—®

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è¿è¡Œé¡¹ç›®

```bash
# å®‰è£…ä¾èµ–
go mod tidy

# è¿è¡ŒæœåŠ¡å™¨
go run cmd/server/main.go
```

### 2. Dockeréƒ¨ç½²

```bash
# æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

### 3. APIæµ‹è¯•

```bash
# ç»™æµ‹è¯•è„šæœ¬æ‰§è¡Œæƒé™
chmod +x test_api.sh

# è¿è¡Œæµ‹è¯•
./test_api.sh
```

## ğŸ“‹ APIæ¥å£

### ç”¨æˆ·ç®¡ç†

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| POST | `/api/users` | åˆ›å»ºç”¨æˆ· |
| GET | `/api/users` | è·å–ç”¨æˆ·åˆ—è¡¨ |
| GET | `/api/users/:id` | è·å–å•ä¸ªç”¨æˆ· |
| PUT | `/api/users/:id` | æ›´æ–°ç”¨æˆ· |
| DELETE | `/api/users/:id` | åˆ é™¤ç”¨æˆ· |
| GET | `/api/users/username/:username` | æ ¹æ®ç”¨æˆ·åè·å–ç”¨æˆ· |

### è®¾å¤‡ç®¡ç†

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| POST | `/api/users/:id/connect` | è¿æ¥è®¾å¤‡ |
| POST | `/api/users/:id/disconnect` | æ–­å¼€è®¾å¤‡ |

### æµé‡ç®¡ç†

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| POST | `/api/users/:id/traffic` | æ›´æ–°æµé‡ä½¿ç”¨ |
| GET | `/api/users/:id/stats` | è·å–ç”¨æˆ·ç»Ÿè®¡ |

### å¥åº·æ£€æŸ¥

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| GET | `/health` | å¥åº·æ£€æŸ¥ |

## ğŸ“Š APIç¤ºä¾‹

### åˆ›å»ºç”¨æˆ·

```bash
curl -X POST http://localhost:8080/api/users \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "testpass123", 
    "expires_at": "2025-12-31T23:59:59Z",
    "traffic_limit": 10737418240,
    "device_limit": 3
  }'
```

### è·å–ç”¨æˆ·ç»Ÿè®¡

```bash
curl http://localhost:8080/api/users/{user_id}/stats
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

- `PORT`: æœåŠ¡ç«¯å£ï¼Œé»˜è®¤8080
- `DATA_FILE`: æ•°æ®æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤`data/users.json`
- `GIN_MODE`: Ginæ¨¡å¼ï¼Œé»˜è®¤`debug`

### ç”¨æˆ·æ•°æ®ç»“æ„

```json
{
  "id": "uuid",
  "username": "ç”¨æˆ·å",
  "password": "å¯†ç ",
  "created_at": "åˆ›å»ºæ—¶é—´",
  "expires_at": "è¿‡æœŸæ—¶é—´",
  "traffic_limit": "æµé‡é™åˆ¶(å­—èŠ‚)",
  "traffic_used": "å·²ç”¨æµé‡(å­—èŠ‚)",
  "device_limit": "è®¾å¤‡æ•°é™åˆ¶",
  "connected_devices": ["è®¾å¤‡IDåˆ—è¡¨"],
  "is_active": true
}
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
sing-box-manager/
â”œâ”€â”€ cmd/server/          # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ api/            # APIå¤„ç†å™¨
â”‚   â”œâ”€â”€ models/         # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ service/        # ä¸šåŠ¡é€»è¾‘
â”‚   â””â”€â”€ storage/        # æ•°æ®å­˜å‚¨
â”œâ”€â”€ data/               # æ•°æ®æ–‡ä»¶
â”œâ”€â”€ configs/            # é…ç½®æ–‡ä»¶
â”œâ”€â”€ Dockerfile          # Dockeræ–‡ä»¶
â”œâ”€â”€ docker-compose.yml  # Docker Compose
â””â”€â”€ test_api.sh         # APIæµ‹è¯•è„šæœ¬
```

## âš¡ æ€§èƒ½ç‰¹æ€§

- âœ… å¹¶å‘å®‰å…¨çš„JSONæ–‡ä»¶è¯»å†™
- âœ… è‡ªåŠ¨è¿‡æœŸç”¨æˆ·æ¸…ç†(æ¯å°æ—¶)
- âœ… å†…å­˜ç¼“å­˜ç”¨æˆ·æ•°æ®
- âœ… é«˜æ€§èƒ½RESTful API
- âœ… æ”¯æŒ1000+ç”¨æˆ·å¹¶å‘

## ğŸ› ï¸ ä¸‹ä¸€æ­¥å¼€å‘

- [ ] é›†æˆsing-boxé…ç½®ç”Ÿæˆ
- [ ] å®ç°é…ç½®çƒ­é‡è½½
- [ ] æ·»åŠ ç”¨æˆ·è®¤è¯
- [ ] é›†æˆç›‘æ§æŒ‡æ ‡
- [ ] æ·»åŠ æ—¥å¿—è®°å½•

## ğŸ“ è®¸å¯è¯

MIT License